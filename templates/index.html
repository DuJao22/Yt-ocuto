<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>YouTube Background Player</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>YouTube Background Player</h1>
            <p class="subtitle">Reproduza playlists e v√≠deos do YouTube em segundo plano</p>
        </div>

        <div class="tabs">
            <button class="tab-btn active" data-tab="player" onclick="switchTab('player')">YouTube</button>
            <button class="tab-btn" data-tab="library" onclick="switchTab('library')">üéµ Biblioteca</button>
            <button class="tab-btn" data-tab="favorites" onclick="switchTab('favorites')">Favoritos</button>
            <button class="tab-btn" data-tab="history" onclick="switchTab('history')">Hist√≥rico</button>
        </div>

        <div id="playerTab" class="tab-content active">
            <div class="input-section">
                <label for="urlInput">Cole a URL da Playlist ou V√≠deo do YouTube:</label>
                <input 
                    type="text" 
                    id="urlInput" 
                    placeholder="https://www.youtube.com/playlist?list=... ou https://youtu.be/..."
                >
            </div>

            <button class="btn-load" onclick="loadMedia()">Carregar e Reproduzir</button>

            <div class="player-ui" id="playerUI">
                <div class="now-playing">
                    <div class="track-title" id="trackTitle">Carregando...</div>
                    <div class="track-info">
                        <span class="playlist-position" id="playlistPos">V√≠deo 1 de 1</span>
                        <span>‚Ä¢</span>
                        <span id="duration">0:00</span>
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="addToFavorites()">‚≠ê Adicionar aos Favoritos</button>
                        <button class="action-btn download-btn" onclick="downloadAudio()">‚¨áÔ∏è Baixar √Åudio (MP3)</button>
                        <button class="action-btn download-btn" onclick="downloadPlaylist()">üì¶ Baixar Playlist Completa (ZIP)</button>
                    </div>
                </div>

                <div class="shuffle-repeat">
                    <button class="toggle-btn" id="shuffleBtn" onclick="toggleShuffle()">
                        Aleat√≥rio
                    </button>
                    <button class="toggle-btn" id="repeatBtn" onclick="toggleRepeat()">
                        Repetir
                    </button>
                </div>

                <div class="controls-grid">
                    <button class="control-btn" onclick="previousTrack()">
                        Anterior
                    </button>
                    <button class="control-btn btn-play-pause" onclick="togglePlayPause()">
                        Pausar
                    </button>
                    <button class="control-btn" onclick="nextTrack()">
                        Pr√≥ximo
                    </button>
                </div>

                <div class="volume-control">
                    <div class="volume-label">
                        <span>Volume</span>
                        <span id="volumePercent">100%</span>
                    </div>
                    <input 
                        type="range" 
                        id="volumeSlider" 
                        min="0" 
                        max="100" 
                        value="100" 
                        oninput="changeVolume(this.value)"
                    >
                </div>

                <div class="info-badge">
                    √Åudio tocando em segundo plano! Minimize a janela tranquilo.
                </div>
            </div>

            <div class="tips">
                <h4>Dicas de Uso:</h4>
                <ul>
                    <li>Cole URLs de playlists: <code>youtube.com/playlist?list=...</code></li>
                    <li>Cole URLs de v√≠deos: <code>youtube.com/watch?v=...</code> ou <code>youtu.be/...</code></li>
                    <li>O √°udio continua mesmo com a aba minimizada</li>
                    <li>Use atalhos: Espa√ßo = Play/Pause, ‚Üí = Pr√≥ximo, ‚Üê = Anterior</li>
                </ul>
            </div>
        </div>

        <div id="libraryTab" class="tab-content">
            <div class="library-player">
                <div class="library-now-playing">
                    <div class="library-track-title" id="libraryTrackTitle">Nenhuma m√∫sica selecionada</div>
                    <div class="library-track-info">
                        <span id="libraryCurrentTime">0:00</span>
                        <span>/</span>
                        <span id="libraryDuration">0:00</span>
                    </div>
                </div>

                <div class="library-progress-container">
                    <input type="range" id="libraryProgressBar" min="0" max="100" value="0" class="library-progress-bar">
                </div>

                <div class="library-controls">
                    <button class="library-control-btn" onclick="libraryPrevious()">‚èÆÔ∏è</button>
                    <button class="library-control-btn library-play-pause" id="libraryPlayBtn" onclick="libraryTogglePlay()">‚ñ∂Ô∏è</button>
                    <button class="library-control-btn" onclick="libraryNext()">‚è≠Ô∏è</button>
                </div>

                <div class="library-volume">
                    <span>üîä</span>
                    <input type="range" id="libraryVolume" min="0" max="100" value="70" class="library-volume-slider">
                    <span id="libraryVolumePercent">70%</span>
                </div>
            </div>

            <div class="library-actions">
                <button class="action-btn" onclick="libraryToggleShuffle()" id="libraryShuffleBtn">üîÄ Aleat√≥rio</button>
                <button class="action-btn" onclick="libraryToggleRepeat()" id="libraryRepeatBtn">üîÅ Repetir</button>
            </div>

            <div class="library-list" id="libraryList">
                <div class="empty-state">
                    <div class="empty-state-icon">üéµ</div>
                    <div class="empty-state-text">Nenhuma m√∫sica na biblioteca.<br>Baixe m√∫sicas do YouTube!</div>
                </div>
            </div>
        </div>

        <div id="favoritesTab" class="tab-content">
            <div class="list-container" id="favoritesList">
                <div class="empty-state">
                    <div class="empty-state-icon">Carregando...</div>
                </div>
            </div>
        </div>

        <div id="historyTab" class="tab-content">
            <div class="list-container" id="historyList">
                <div class="empty-state">
                    <div class="empty-state-icon">Carregando...</div>
                </div>
            </div>
            <button class="clear-btn" id="clearHistoryBtn" onclick="clearHistory()" style="display: none;">
                Limpar Hist√≥rico
            </button>
        </div>
    </div>

    <div id="player"></div>
    <div id="toast" class="toast"></div>

    <footer class="credits">
        <div class="credits-text">Desenvolvido por <strong>Joao Layon</strong> - Desenvolvedor Full Stack</div>
    </footer>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="{{ url_for('static', filename='js/player.js') }}"></script>
</body>
</html>
